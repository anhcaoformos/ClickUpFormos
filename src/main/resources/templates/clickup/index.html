<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Title</title>
    <style type="text/css" xml:space="preserve">
      body {
        font-family: -apple-system, BlinkMacSystemFont, Segoe UI, roboto, Helvetica Neue, helvetica, arial, sans-serif;
        font-size: 13px;
      }
      .container {
        display: -webkit-flex;
        display: flex;
        -webkit-flex-direction: column;
        flex-direction: column;
      }
      .row_start {
        display: -webkit-box; /* wkhtmltopdf uses this one */
        display: flex;
        -webkit-box-pack: start; /* wkhtmltopdf uses this one */
        justify-content: start;
        -webkit-box-align: center;
        align-items: center;
      }
      .user_header_img {
        border-radius: 50%;
        display: -webkit-box; /* wkhtmltopdf uses this one */
        display: flex;
        -webkit-box-pack: center; /* wkhtmltopdf uses this one */
        justify-content: center;
        -webkit-box-align: center;
        width: 25px;
        height: 25px;
        margin-right: 10px;
        font-size: 10px;
      }
      .separate_div {
        width: 20px;
        height: 25px;
        border-left: 1px solid #2a2e34;
        margin-left: 20px;
      }
      .priority {
        width: 36px;
        height: 36px;
        padding: 8px 6px 8px 10px;
        border-radius: 50%;
        fill: rgb(255, 204, 0);
        border: 1px solid rgb(255, 204, 0);
        margin-left: 10px;
      }
      .tag {
        border-radius: 2px 13px 13px 2px;
        margin: 0 4px 4px 0;
        padding: 0 10px 0 8px;
        text-align: center;
      }
      .task_body {
        border: 1px solid #e9ebf0;
        border-radius: 8px;
        padding-left: 10px;
      }
      .task_image {
        width: auto;
        height: auto;
      }
      .comment_body {
        border: 1px solid #e9ebf0;
        border-radius: 8px;
      }
      .comment_container {
        border: 2px solid #e9ebf0;
        border-radius: 8px;
        margin-bottom: 30px;
        padding-left: 20px;
      }
      .comment_image {
        width: 160px;
        height: 100px;
      }
      .comment_child {
        margin-left: 40px;
        margin-bottom: 10px;
      }
      #attachments {
        display: -webkit-flex;
        display: flex;
        /*-webkit-flex: auto;*/
        -webkit-flex-direction: column;
        flex-direction: column;
        overflow: auto;
        max-width: 100%;
      }
      .attachment_body {
        justify-content: center;
      }
      .attachment_image {
        width: 200px;
        height: auto;
        max-width: 100%;
      }
      .attachment_grid {
        justify-content: center;
        display: table;
        border-radius: 8px;
        border: 1px solid #e9ebf0;
        width: 100%;
      }
      .attachment_item {
        height: 160px;
        width: 200px;
        max-width: 100%;
        display: -webkit-box; /* wkhtmltopdf uses this one */
        display: flex;
        -webkit-box-pack: center; /* wkhtmltopdf uses this one */
        justify-content: center;
        -webkit-box-align: center;
      }
      .attachment_card {
        border-radius: 8px;
        border: 1px solid #e9ebf0;
        break-inside: avoid;
        float: left;
        width: calc(20% - 24px);
        margin: 10px 10px;
      }
      .attachment_title {
        text-align: center;
      }
      .row {
        display: -webkit-box; /* wkhtmltopdf uses this one */
        display: flex;
        -webkit-box-pack: justify; /* wkhtmltopdf uses this one */
        justify-content: space-between;
        align-items: center;
        margin: 10px;
      }
      .comment_title {
        display: -webkit-box; /* wkhtmltopdf uses this one */
        display: flex;
        -webkit-box-pack: start; /* wkhtmltopdf uses this one */
        justify-content: start;
        -webkit-box-align: center;
      }
      .user_img {
        border-radius: 50%;
        display: -webkit-box; /* wkhtmltopdf uses this one */
        display: flex;
        -webkit-box-pack: center; /* wkhtmltopdf uses this one */
        justify-content: center;
        -webkit-box-align: center;
        width: 20px;
        height: 20px;
        margin-right: 10px;
        font-size: 10px;
      }
      .separate_sections {
        margin-top: 10px;
      }
      .pre-wrap {
        white-space: pre-wrap;
      }
      .page_break_inside {
        page-break-inside: avoid !important;
      }
      .block_image {
        display: block;
      }
      .block_image_attachment {
        display: -webkit-box;
        -webkit-box-pack: center; /* wkhtmltopdf uses this one */
        justify-content: center;
        -webkit-box-align: center;
      }
      .code {
        border: 1px solid #e4e4e4;
        background: #f7f7f7;
        border-radius: 2px;
        white-space: pre-wrap;
        padding: 2px 4px;
        line-height: 1;
        font-size: 100% !important;
        color: #d16464 !important;
      }
      .quote {
        font-style: italic;
        padding-left: 15px;
        margin-top: 10px;
        margin-bottom: 10px;
        border-inline-start: 4px solid #d6d9de;
        border-left: 2px solid #d6d9de;
      }
      .emoji {
        height: 1em;
        width: 1em;
        margin: 0 0.05em 0 0.1em;
        vertical-align: -0.1em;
      }
      .banner {
        margin-top: 10px;
        margin-bottom: 10px;
        padding-left: 40px;
      }
      .status {
        border-radius: 3px;
        border: 1px;
        padding: 0 3px 0 3px;
      }
      table {
        border-collapse: collapse;
      }
      table tr td {
        border: 1px solid;
        padding: 5px 10px;
      }
      .subtask_status {
        height: 15px;
        width: 15px;
        margin: 0 10px 0 0;
        padding: 0;
      }
      .mr10px {
        margin-right: 10px;
      }
      .ml10px {
        margin-left: 10px;
      }
      .pr10px {
        padding-right: 10px;
      }
      .pl10px {
        padding-left: 10px;
      }
      .assignee_item {
        width: 30%;
      }
      .mt_mb_10px {
        margin-top: 10px;
        margin-bottom: 10px;
      }
      .date_time {
        font-size: 11px;
        font-weight: 400;
        flex-shrink: 0;
        margin: 0 0 0 10px;
        padding: 4px 0 0;
        color: #abaeb0;
      }
      .truncate_text {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        max-width: 700px;
      }
      .comment_attachment {
        height: auto;
        background: #e9ebf0;
        align-items: center;
        border-radius: 3px;
      }
      .comment_attachment_image {
        width: 40px;
        height: 30px;
      }
      .width100 {
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="row_start">
        <div class="status mr10px" th:style="${'background-color: ' + task.getStatusColor()}" th:text="${task.getStatus()}"></div>
        <div
          class="user_header_img mr10px"
          th:text="${task.getCreator().getInitials()}"
          th:style="'background:' + ${task.getCreator().getColor()}"
        ></div>
        <div class="separate_div mr10px"></div>
        <div class="mr10px">
          <svg width="25px" height="25px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M5 1C4.44772 1 4 1.44772 4 2V22C4 22.5523 4.44772 23 5 23C5.55228 23 6 22.5523 6 22V14H19C19.3603 14 19.6927 13.8062 19.8702 13.4927C20.0477 13.1792 20.0429 12.7944 19.8575 12.4855L17.1662 8L19.8575 3.5145C20.0429 3.20556 20.0477 2.82081 19.8702 2.5073C19.6927 2.19379 19.3603 2 19 2L6 2C6 1.44772 5.55228 1 5 1ZM6 4V12H17.2338L15.1425 8.5145C14.9525 8.19781 14.9525 7.80219 15.1425 7.4855L17.2338 4H6Z"
              th:fill="${task.getPriorityColor()}"
            />
          </svg>
        </div>
      </div>
      <hr style="margin: 20px" />
      <div class="row_start" th:if="${not #lists.isEmpty(task.getTags())}">
        <div
          class="tag mr10px"
          th:each="tag : ${task.getTags()}"
          th:style="'background: ' + ${tag.getTagBackground()} + '; text-decoration: ' + ${tag.getTagForeground()} + ';'"
          th:text="${tag.getName()}"
        ></div>
      </div>
      <div>
        <div id="task">
          <div class="task_body">
            <div class="row">
              <div>
                <h2 th:utext="${task.getName()}"></h2>
              </div>
            </div>
            <div>
              <p th:utext="${task.getDescription()}"></p>
            </div>
          </div>
        </div>
        <div id="subtasks" th:if="${not #lists.isEmpty(task.getSubtasks())}">
          <hr class="separate_sections" />
          <h2>Subtasks:</h2>
          <div class="row_start" th:each="subtask : ${task.getSubtasks()}">
            <div
              class="subtask_status"
              th:style="'border: 1px solid ' + ${subtask.getStatusColor()} + '; background: ' + ${subtask.getStatusColor()} + ';'"
            ></div>
            <div class="mr10px" th:text="${subtask.getName()}"></div>
            <div th:if="${not #lists.isEmpty(subtask.getAssignees())}" th:each="assignee : ${subtask.getAssignees()}">
              <div class="user_img" th:text="${assignee.getInitials()}" th:style="'background:' + ${assignee.getColor()}"></div>
            </div>
            <div class="mr10px">
              <svg width="25px" height="25px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M5 1C4.44772 1 4 1.44772 4 2V22C4 22.5523 4.44772 23 5 23C5.55228 23 6 22.5523 6 22V14H19C19.3603 14 19.6927 13.8062 19.8702 13.4927C20.0477 13.1792 20.0429 12.7944 19.8575 12.4855L17.1662 8L19.8575 3.5145C20.0429 3.20556 20.0477 2.82081 19.8702 2.5073C19.6927 2.19379 19.3603 2 19 2L6 2C6 1.44772 5.55228 1 5 1ZM6 4V12H17.2338L15.1425 8.5145C14.9525 8.19781 14.9525 7.80219 15.1425 7.4855L17.2338 4H6Z"
                  th:fill="${subtask.getPriorityColor()}"
                />
              </svg>
            </div>
            <div class="mr10px" th:text="${subtask.getDueDate()}"></div>
            <div class="mr10px" th:if="${not #lists.isEmpty(subtask.getTags())}" th:each="tag : ${subtask.getTags()}">
              <div
                class="tag"
                th:style="'background: ' + ${tag.getTagBackground()} + '; text-color: ' + ${tag.getTagForeground()} + ';'"
                th:text="${tag.getName()}"
              ></div>
            </div>
          </div>
        </div>
        <div id="highlightComments" th:if="${not #lists.isEmpty(task.getHighlightComments())}">
          <hr class="separate_sections" />
          <div th:each="highlightComment : ${task.getHighlightComments()}">
            <div class="row_start mt_mb_10px">
              <input class="mr10px" type="checkbox" th:checked="${highlightComment.getResolved()}" />
              <div
                th:if="${highlightComment.getCommentAttachmentId() == null}"
                class="user_img mr10px"
                th:text="${highlightComment.getAssignee().getInitials()}"
                th:style="'background:' + ${highlightComment.getAssignee().getColor()}"
              ></div>
              <div
                class="mr10px truncate_text"
                th:if="${highlightComment.getCommentAttachmentId() == null}"
                th:utext="${highlightComment.getRawText()}"
              ></div>
              <div th:if="${highlightComment.getCommentAttachmentId() != null}" class="comment_attachment">
                <img
                  class="comment_attachment_image"
                  th:src="${task.getBaseImagePath() + '\\/' + highlightComment.getCommentAttachmentId()}"
                />
              </div>
              <div class="mr10px width100" th:if="${highlightComment.getCommentAttachmentId() != null}">
                <div class="row">
                  <div class="comment_title">
                    <div
                      class="user_img"
                      th:text="${highlightComment.getUser().getInitials()}"
                      th:style="'background:' + ${highlightComment.getUser().getColor()}"
                    ></div>
                    <h5 th:text="${highlightComment.getUsername()}"></h5>
                  </div>
                  <div class="date_time"><h5 th:text="${highlightComment.getDateTime()}"></h5></div>
                </div>
                <div class="mt_mb_10px ml10px">
                  <div th:utext="${highlightComment.getHtmlText()}"></div>
                  <hr th:if="${highlightComment.getAssignee() != null}" />
                  <div class="row_start" th:if="${highlightComment.getAssignee() != null}">
                    <div class="comment_title assignee_item" th:if="${highlightComment.getAssignee() != null}">
                      <div
                        class="user_img"
                        th:text="${highlightComment.getAssignee().getInitials()}"
                        th:style="'background:' + ${highlightComment.getAssignee().getColor()}"
                      ></div>
                      <div>
                        <span
                          th:if="${highlightComment.getAssignee().getUsername() != null}"
                          th:text="|Assignee: ${highlightComment.getAssignee().getUsername()}|"
                        ></span>
                      </div>
                    </div>
                    <div class="comment_title assignee_item" th:if="${highlightComment.getAssignedBy() != null}">
                      <div
                        class="user_img"
                        th:text="${highlightComment.getAssignedBy().getInitials()}"
                        th:style="'background:' + ${highlightComment.getAssignedBy().getColor()}"
                      ></div>
                      <div>
                        <span
                          th:if="${highlightComment.getAssignedBy().getUsername() != null}"
                          th:text="|Assigned By: ${highlightComment.getAssignedBy().getUsername()}|"
                        ></span>
                      </div>
                    </div>
                    <div class="comment_title assignee_item" th:if="${highlightComment.getResolvedBy() != null}">
                      <div
                        class="user_img"
                        th:text="${highlightComment.getResolvedBy().getInitials()}"
                        th:style="'background:' + ${highlightComment.getResolvedBy().getColor()}"
                      ></div>
                      <div>
                        <span
                          th:if="${highlightComment.getResolvedBy().getUsername() != null}"
                          th:text="|Resolved By: ${highlightComment.getResolvedBy().getUsername()}|"
                        ></span>
                      </div>
                    </div>
                  </div>
                </div>
                <hr th:if="${not #lists.isEmpty(highlightComment.getChildren())}" class="separate_sections" />
                <div
                  class="comment_body comment_child mr10px page_break_inside pl10px pr10px"
                  th:if="${not #lists.isEmpty(highlightComment.getChildren())}"
                  th:each="child : ${highlightComment.getChildren()}"
                >
                  <div class="row">
                    <div class="comment_title">
                      <div
                        class="user_img"
                        th:text="${child.getUser().getInitials()}"
                        th:style="'background:' + ${child.getUser().getColor()}"
                      ></div>
                      <h6 th:text="${child.getUsername()}"></h6>
                    </div>
                    <div class="date_time"><h6 th:text="${child.getDateTime()}"></h6></div>
                  </div>
                  <div>
                    <div th:utext="${child.getHtmlText()}"></div>
                    <hr th:if="${child.getAssignee() != null}" />
                    <div class="row_start" th:if="${child.getAssignee() != null}">
                      <div class="comment_title assignee_item" th:if="${child.getAssignee() != null}">
                        <div
                          class="user_img"
                          th:text="${child.getAssignee().getInitials()}"
                          th:style="'background:' + ${child.getAssignee().getColor()}"
                        ></div>
                        <div>
                          <span
                            th:if="${child.getAssignee().getUsername() != null}"
                            th:text="|Assignee: ${child.getAssignee().getUsername()}|"
                          ></span>
                        </div>
                      </div>
                      <div class="comment_title assignee_item" th:if="${child.getAssignedBy() != null}">
                        <div
                          class="user_img"
                          th:text="${child.getAssignedBy().getInitials()}"
                          th:style="'background:' + ${child.getAssignedBy().getColor()}"
                        ></div>
                        <div>
                          <span
                            th:if="${child.getAssignedBy().getUsername() != null}"
                            th:text="|Assigned By: ${child.getAssignedBy().getUsername()}|"
                          ></span>
                        </div>
                      </div>
                      <div class="comment_title assignee_item" th:if="${child.getResolvedBy() != null}">
                        <div
                          class="user_img"
                          th:text="${child.getResolvedBy().getInitials()}"
                          th:style="'background:' + ${child.getResolvedBy().getColor()}"
                        ></div>
                        <div>
                          <span
                            th:if="${child.getResolvedBy().getUsername() != null}"
                            th:text="|Resolved By: ${child.getResolvedBy().getUsername()}|"
                          ></span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="checklists" th:if="${not #lists.isEmpty(task.getChecklists())}">
          <hr class="separate_sections" />
          <div th:each="checklist : ${task.getChecklists()}">
            <div th:if="${not #lists.isEmpty(checklist.getItems())}" class="page_break_inside">
              <h2>Checklist</h2>
              <div th:each="checklistItem : ${checklist.getItems()}">
                <div class="row_start mt_mb_10px">
                  <input class="mr10px" type="checkbox" th:checked="${checklistItem.getResolved()}" />
                  <div class="mr10px" th:text="${checklistItem.getName()}"></div>
                  <div
                    th:if="${checklistItem.getAssignee() !=  null}"
                    class="user_img mr10px"
                    th:text="${checklistItem.getAssignee().getInitials()}"
                    th:style="'background:' + ${checklistItem.getAssignee().getColor()}"
                  ></div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="attachments" th:if="${not #sets.isEmpty(task.getAttachments())}">
          <hr class="separate_sections" />
          <h2>Attachments:</h2>
          <div class="attachment_body page_break_inside">
            <div class="attachment_grid">
              <div class="attachment_card" th:each="attachment : ${task.getAttachments()}">
                <div class="attachment_item">
                  <a th:if="${not attachment.isImage()}" th:href="${attachment.getId()}" th:text="${attachment.getTitle()}"></a>
                  <a class="block_image_attachment" th:if="${attachment.isImage()}" th:href="${attachment.getId()}">
                    <img class="attachment_image page_break_inside" th:src="${task.getBaseImagePath() + '\\' + attachment.getId()}" />
                  </a>
                </div>
                <h6 class="attachment_title" th:text="${attachment.getDateTime()}"></h6>
              </div>
            </div>
          </div>
        </div>
        <div id="comments" th:if="${not #lists.isEmpty(task.getComments())}">
          <hr class="separate_sections" />
          <h2>Comments:</h2>
          <div th:each="comment : ${task.getComments()}" class="comment_container page_break_inside pl10px pr10px">
            <div class="row">
              <div class="comment_title">
                <div
                  class="user_img"
                  th:text="${comment.getUser().getInitials()}"
                  th:style="'background:' + ${comment.getUser().getColor()}"
                ></div>
                <h5 th:text="${comment.getUsername()}"></h5>
              </div>
              <div class="date_time"><h5 th:text="${comment.getDateTime()}"></h5></div>
            </div>
            <div class="mt_mb_10px ml10px">
              <div th:utext="${comment.getHtmlText()}"></div>
              <hr th:if="${comment.getAssignee() != null}" />
              <div class="row_start" th:if="${comment.getAssignee() != null}">
                <div class="comment_title assignee_item" th:if="${comment.getAssignee() != null}">
                  <div
                    class="user_img"
                    th:text="${comment.getAssignee().getInitials()}"
                    th:style="'background:' + ${comment.getAssignee().getColor()}"
                  ></div>
                  <div>
                    <span
                      th:if="${comment.getAssignee().getUsername() != null}"
                      th:text="|Assignee: ${comment.getAssignee().getUsername()}|"
                    ></span>
                  </div>
                </div>
                <div class="comment_title assignee_item" th:if="${comment.getAssignedBy() != null}">
                  <div
                    class="user_img"
                    th:text="${comment.getAssignedBy().getInitials()}"
                    th:style="'background:' + ${comment.getAssignedBy().getColor()}"
                  ></div>
                  <div>
                    <span
                      th:if="${comment.getAssignedBy().getUsername() != null}"
                      th:text="|Assigned By: ${comment.getAssignedBy().getUsername()}|"
                    ></span>
                  </div>
                </div>
                <div class="comment_title assignee_item" th:if="${comment.getResolvedBy() != null}">
                  <div
                    class="user_img"
                    th:text="${comment.getResolvedBy().getInitials()}"
                    th:style="'background:' + ${comment.getResolvedBy().getColor()}"
                  ></div>
                  <div>
                    <span
                      th:if="${comment.getResolvedBy().getUsername() != null}"
                      th:text="|Resolved By: ${comment.getResolvedBy().getUsername()}|"
                    ></span>
                  </div>
                </div>
              </div>
            </div>
            <hr th:if="${not #lists.isEmpty(comment.getChildren())}" class="separate_sections" />
            <div
              class="comment_body comment_child mr10px page_break_inside pl10px pr10px"
              th:if="${not #lists.isEmpty(comment.getChildren())}"
              th:each="child : ${comment.getChildren()}"
            >
              <div class="row">
                <div class="comment_title">
                  <div
                    class="user_img"
                    th:text="${child.getUser().getInitials()}"
                    th:style="'background:' + ${child.getUser().getColor()}"
                  ></div>
                  <h6 th:text="${child.getUsername()}"></h6>
                </div>
                <div class="date_time"><h6 th:text="${child.getDateTime()}"></h6></div>
              </div>
              <div>
                <div th:utext="${child.getHtmlText()}"></div>
                <hr th:if="${child.getAssignee() != null}" />
                <div class="row_start" th:if="${child.getAssignee() != null}">
                  <div class="comment_title assignee_item" th:if="${child.getAssignee() != null}">
                    <div
                      class="user_img"
                      th:text="${child.getAssignee().getInitials()}"
                      th:style="'background:' + ${child.getAssignee().getColor()}"
                    ></div>
                    <div>
                      <span
                        th:if="${child.getAssignee().getUsername() != null}"
                        th:text="|Assignee: ${child.getAssignee().getUsername()}|"
                      ></span>
                    </div>
                  </div>
                  <div class="comment_title assignee_item" th:if="${child.getAssignedBy() != null}">
                    <div
                      class="user_img"
                      th:text="${child.getAssignedBy().getInitials()}"
                      th:style="'background:' + ${child.getAssignedBy().getColor()}"
                    ></div>
                    <div>
                      <span
                        th:if="${child.getAssignedBy().getUsername() != null}"
                        th:text="|Assigned By: ${child.getAssignedBy().getUsername()}|"
                      ></span>
                    </div>
                  </div>
                  <div class="comment_title assignee_item" th:if="${child.getResolvedBy() != null}">
                    <div
                      class="user_img"
                      th:text="${child.getResolvedBy().getInitials()}"
                      th:style="'background:' + ${child.getResolvedBy().getColor()}"
                    ></div>
                    <div>
                      <span
                        th:if="${child.getResolvedBy().getUsername() != null}"
                        th:text="|Resolved By: ${child.getResolvedBy().getUsername()}|"
                      ></span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
